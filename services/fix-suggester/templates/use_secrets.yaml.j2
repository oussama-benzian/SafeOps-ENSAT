{# Template for using secrets instead of hardcoded credentials #}
# Fix: Use GitHub Secrets for Credentials
# Rule: {{ rule_id }}
# Severity: {{ severity }}
# Description: {{ description }}

# Original (insecure - hardcoded credential):
# env:
#   {{ credential_name }}: "{{ masked_value }}"
# OR
# run: |
#   {{ credential_name }}={{ masked_value }}

# Recommended fix:
# 1. Add the secret to your repository settings
#    Go to: Repository Settings > Secrets and variables > Actions > New repository secret
#    Name: {{ secret_name | upper | replace('-', '_') }}
#    Value: (your actual credential value)

# 2. Reference the secret in your workflow:
env:
  {{ credential_name }}: ${{ '{{' }} secrets.{{ secret_name | upper | replace('-', '_') }} {{ '}}' }}

# For organization-wide secrets:
env:
  {{ credential_name }}: ${{ '{{' }} secrets.{{ secret_name | upper | replace('-', '_') }} || secrets.ORG_{{ secret_name | upper | replace('-', '_') }} {{ '}}' }}

# Best practices:
# - Never commit secrets to your repository
# - Use environment-specific secrets for different deployment targets
# - Rotate secrets regularly
# - Use OIDC where possible instead of long-lived credentials
